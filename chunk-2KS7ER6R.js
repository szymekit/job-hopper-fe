import{q as J}from"./chunk-2QYDXULY.js";import{i as R,k as q}from"./chunk-PD4IKBLU.js";import{a as C}from"./chunk-GDX5ZT5J.js";import{a as V}from"./chunk-LIPKMQYY.js";import{a as G,c as d}from"./chunk-G6XE52Q4.js";import{x as H,y as K}from"./chunk-T3VJ5NW5.js";import{$ as _,$a as E,A as g,Aa as S,Db as j,Ea as r,Fb as l,Gb as p,Pb as B,Ra as I,S as f,W as x,a as b,ab as v,b as P,cb as h,da as k,ea as F,fb as A,gb as N,hb as $,ib as n,jb as s,kb as z,m,na as y,ob as T,q as w,qb as U,rb as c,sc as u,uc as L}from"./chunk-6R5FC44M.js";var D=class o{http=_(L);baseUrl=G;getAll(t){let e=new u;return t?.page&&(e=e.set("page",t.page.toString())),t?.limit&&(e=e.set("limit",t.limit.toString())),this.http.get(`${this.baseUrl}${d.feed.getAll}`,{params:e})}getByCompany(t,e){let i=new u;return e?.page&&(i=i.set("page",e.page.toString())),e?.limit&&(i=i.set("limit",e.limit.toString())),this.http.get(`${this.baseUrl}${d.feed.getByCompany(t)}`,{params:i})}getByUser(t,e){let i=new u;return e?.page&&(i=i.set("page",e.page.toString())),e?.limit&&(i=i.set("limit",e.limit.toString())),this.http.get(`${this.baseUrl}${d.feed.getByUser(t)}`,{params:i})}getById(t){return this.http.get(`${this.baseUrl}${d.feed.getById(t)}`)}create(t,e){let i=new u().set("companyId",t);return this.http.post(`${this.baseUrl}${d.feed.create}`,e,{params:i})}update(t,e){return this.http.patch(`${this.baseUrl}${d.feed.update(t)}`,e)}delete(t){return this.http.delete(`${this.baseUrl}${d.feed.delete(t)}`)}like(t){return this.http.post(`${this.baseUrl}${d.feed.like(t)}`,{})}unlike(t){return this.http.delete(`${this.baseUrl}${d.feed.unlike(t)}`)}getComments(t,e){let i=new u;return e?.page&&(i=i.set("page",e.page.toString())),e?.limit&&(i=i.set("limit",e.limit.toString())),this.http.get(`${this.baseUrl}${d.feed.getComments(t)}`,{params:i})}createComment(t,e){return this.http.post(`${this.baseUrl}${d.feed.createComment(t)}`,e)}deleteComment(t){return this.http.delete(`${this.baseUrl}${d.feed.deleteComment(t)}`)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};var M=class o{feedApi=_(D);notifications=_(V);loading=y(!1);error=y(null);posts=y([]);loadFeed(t){this.loading.set(!0),this.error.set(null),this.feedApi.getAll(t).pipe(w(e=>Array.isArray(e)?e:e&&typeof e=="object"&&"data"in e?e.data||[]:[]),f(e=>{this.posts.set(e)}),g(e=>{let i=C(e);return this.error.set(i),this.notifications.showError(i,{title:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 feedu"}),m([])})).subscribe(()=>{this.loading.set(!1)})}loadByCompany(t,e){this.loading.set(!0),this.error.set(null),this.feedApi.getByCompany(t,e).pipe(w(i=>Array.isArray(i)?i:i&&typeof i=="object"&&"data"in i?i.data||[]:[]),f(i=>{this.posts.set(i)}),g(i=>{let a=C(i);return this.error.set(a),this.notifications.showError(a,{title:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 post\xF3w firmy"}),m([])})).subscribe(()=>{this.loading.set(!1)})}createPost(t,e){this.feedApi.create(t,e).pipe(f(i=>{this.posts.update(a=>[i,...a]),this.notifications.showSuccess("Post zosta\u0142 opublikowany.")}),g(i=>{let a=C(i);return this.notifications.showError(a,{title:"Nie uda\u0142o si\u0119 opublikowa\u0107 posta"}),m({})})).subscribe()}likePost(t){this.feedApi.like(t).pipe(f(()=>{this.posts.update(e=>e.map(i=>i.id===t?P(b({},i),{isLiked:!0,likesCount:i.likesCount+1}):i))}),g(e=>(console.error("Failed to like post:",e),m(void 0)))).subscribe()}unlikePost(t){this.feedApi.unlike(t).pipe(f(()=>{this.posts.update(e=>e.map(i=>i.id===t?P(b({},i),{isLiked:!1,likesCount:Math.max(0,i.likesCount-1)}):i))}),g(e=>(console.error("Failed to unlike post:",e),m(void 0)))).subscribe()}createComment(t,e){this.feedApi.createComment(t,e).pipe(f(()=>{this.posts.update(i=>i.map(a=>a.id===t?P(b({},a),{commentsCount:a.commentsCount+1}):a)),this.notifications.showSuccess("Komentarz zosta\u0142 dodany.")}),g(i=>{let a=C(i);return this.notifications.showError(a,{title:"Nie uda\u0142o si\u0119 doda\u0107 komentarza"}),m({})})).subscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};var X=()=>[],Y=(o,t)=>t.id;function Z(o,t){o&1&&(n(0,"div",3),l(1,"\u0141adowanie..."),s())}function ee(o,t){if(o&1&&(n(0,"div",4),l(1),s()),o&2){let e=c();r(),p(e.error())}}function te(o,t){if(o&1&&z(0,"img",8),o&2){let e=c().$implicit;$("src",e.author.avatarUrl,S)("alt",e.author.fullName||"")}}function ie(o,t){if(o&1&&(n(0,"p",11),l(1),s()),o&2){let e=c().$implicit;r(),p(e.company.name)}}function oe(o,t){if(o&1&&z(0,"img",14),o&2){let e=c().$implicit;$("src",e.imageUrl,S)("alt",e.content)}}function ae(o,t){if(o&1){let e=T();n(0,"article",6)(1,"div",7),v(2,te,1,2,"img",8),n(3,"div",9)(4,"h3",10),l(5),s(),v(6,ie,2,1,"p",11),n(7,"time",12),l(8),s()()(),n(9,"p",13),l(10),s(),v(11,oe,1,2,"img",14),n(12,"div",15)(13,"button",16),U("click",function(){let a=k(e).$implicit,O=c(2);return F(O.toggleLike(a))}),n(14,"mat-icon"),l(15),s(),n(16,"span",17),l(17),s()(),n(18,"button",18),U("click",function(){let a=k(e).$implicit,O=c(2);return F(O.toggleComments(a.id))}),n(19,"mat-icon"),l(20,"comment"),s(),n(21,"span",17),l(22),s()()()()}if(o&2){let e=t.$implicit,i=c(2);r(2),h(e.author!=null&&e.author.avatarUrl?2:-1),r(3),p(e.author==null?null:e.author.fullName),r(),h(e.company?6:-1),r(2),p(i.formatDate(e.createdAt)),r(2),p(e.content),r(),h(e.imageUrl?11:-1),r(2),j("feed-page__post-action--active",e.isLiked),E("aria-label",e.isLiked?"Usu\u0144 polubienie":"Polub"),r(2),p(e.isLiked?"favorite":"favorite_border"),r(2),p(e.likesCount),r(5),p(e.commentsCount)}}function ne(o,t){if(o&1&&(n(0,"div",5),A(1,ae,23,12,"article",6,Y),s()),o&2){let e=c();r(),N(e.posts()||B(0,X))}}var W=class o{facade=_(M);loading=this.facade.loading;error=this.facade.error;posts=this.facade.posts;ngOnInit(){this.facade.loadFeed()}toggleLike(t){t.isLiked?this.facade.unlikePost(t.id):this.facade.likePost(t.id)}toggleComments(t){console.log("Toggle comments for post:",t)}formatDate(t){return new Date(t).toLocaleDateString("pl-PL",{day:"numeric",month:"long",year:"numeric"})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=I({type:o,selectors:[["jh-feed-page"]],decls:7,vars:1,consts:[[1,"feed-page"],[1,"feed-page__header"],[1,"feed-page__title"],[1,"feed-page__loading"],[1,"feed-page__error"],[1,"feed-page__list"],[1,"feed-page__post"],[1,"feed-page__post-header"],[1,"feed-page__post-avatar",3,"src","alt"],[1,"feed-page__post-author-info"],[1,"feed-page__post-author-name"],[1,"feed-page__post-company"],[1,"feed-page__post-date"],[1,"feed-page__post-content"],[1,"feed-page__post-image",3,"src","alt"],[1,"feed-page__post-actions"],["mat-icon-button","",1,"feed-page__post-action",3,"click"],[1,"feed-page__post-action-text"],["mat-icon-button","","aria-label","Komentarze",1,"feed-page__post-action",3,"click"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),l(3,"Feed"),s()(),v(4,Z,2,0,"div",3)(5,ee,2,1,"div",4)(6,ne,3,1,"div",5),s()),e&2&&(r(4),h(i.loading()?4:i.error()?5:6))},dependencies:[J,K,H,q,R],styles:[".feed-page[_ngcontent-%COMP%]{min-height:100vh;background-color:var(--color-bg-secondary);padding:var(--spacing-4xl);max-width:800px;margin:0 auto}.feed-page__header[_ngcontent-%COMP%]{margin-bottom:var(--spacing-4xl)}.feed-page__title[_ngcontent-%COMP%]{font-size:var(--font-size-5xl);font-weight:var(--font-weight-bold);color:var(--color-text-primary);margin:0}.feed-page__list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-3xl)}.feed-page__post[_ngcontent-%COMP%]{background-color:var(--color-bg-primary);border-radius:var(--radius-md);box-shadow:var(--shadow-sm);padding:var(--spacing-3xl)}.feed-page__post-header[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-lg);margin-bottom:var(--spacing-lg)}.feed-page__post-avatar[_ngcontent-%COMP%]{width:var(--size-avatar-md);height:var(--size-avatar-md);border-radius:var(--radius-full);object-fit:cover}.feed-page__post-author-info[_ngcontent-%COMP%]{flex:1}.feed-page__post-author-name[_ngcontent-%COMP%]{font-size:var(--font-size-base);font-weight:var(--font-weight-semibold);color:var(--color-text-primary);margin:0 0 var(--spacing-xs)}.feed-page__post-company[_ngcontent-%COMP%]{font-size:var(--font-size-sm);color:var(--color-text-secondary);margin:0 0 var(--spacing-xs)}.feed-page__post-date[_ngcontent-%COMP%]{font-size:var(--font-size-xs);color:var(--color-text-muted)}.feed-page__post-content[_ngcontent-%COMP%]{font-size:var(--font-size-base);color:var(--color-text-primary);line-height:var(--line-height-relaxed);margin:0 0 var(--spacing-lg)}.feed-page__post-image[_ngcontent-%COMP%]{width:100%;border-radius:var(--radius-md);margin-bottom:var(--spacing-lg)}.feed-page__post-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-xl);padding-top:var(--spacing-lg);border-top:var(--border-width-thin) solid var(--color-border-default)}.feed-page__post-action[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);color:var(--color-text-secondary);font-size:var(--font-size-base);font-weight:var(--font-weight-medium);padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--radius-md);transition:all var(--transition-base)}.feed-page__post-action[_ngcontent-%COMP%]:hover{background-color:var(--color-bg-secondary);color:var(--color-text-primary)}.feed-page__post-action--active[_ngcontent-%COMP%]{color:var(--color-btn-primary)}.feed-page__post-action--active[_ngcontent-%COMP%]:hover{background-color:#4a90e21a}.feed-page__post-action--active[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--color-btn-primary)}.feed-page__post-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:20px;height:20px;font-size:20px;color:inherit}.feed-page__post-action[_ngcontent-%COMP%]   .feed-page__post-action-text[_ngcontent-%COMP%]{font-size:var(--font-size-sm);font-weight:var(--font-weight-medium);line-height:1}.feed-page__loading[_ngcontent-%COMP%], .feed-page__error[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-8xl);color:var(--color-text-secondary)}@media (max-width: 419px){.feed-page[_ngcontent-%COMP%]{padding:var(--spacing-2xl)}}"],changeDetection:0})};export{W as FeedPageComponent};
