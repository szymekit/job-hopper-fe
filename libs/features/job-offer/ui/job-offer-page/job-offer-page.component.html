<div class="job-offer-page">
  <main class="job-offer-page__main">
    <div class="job-offer-page__container">
      @if (loading()) {
        <div>Ładowanie...</div>
      } @else if (error()) {
        <div>Błąd: {{ error() }}</div>
      } @else if (data()) {
        <article class="job-offer-card">
          <div class="job-offer-card__header">
            <img class="job-offer-card__logo" [src]="data()!.details.header.logoUrl" [alt]="data()!.details.header.companyName" />
            <div class="job-offer-card__info">
              <h1 class="job-offer-card__title">{{ data()!.details.title }}</h1>
              <div class="job-offer-card__meta">
                <span>{{ data()!.details.header.companyName }} {{ data()!.details.header.location }}</span>
                <span>{{ data()!.details.salary }}</span>
                <span>{{ data()!.details.activeDays }}</span>
              </div>
              <p class="job-offer-card__description">{{ data()!.details.description }}</p>
              <div class="job-offer-card__tags">
                @for (tag of data()!.details.tags; track tag) {
                  <span class="job-offer-card__tag">{{ tag }}</span>
                }
              </div>
            </div>
          </div>
        </article>

        @if (data()!.about.items && data()!.about.items.length > 0) {
          <section class="job-offer-section">
            <h2 class="job-offer-section__title">{{ data()!.about.title }}</h2>
            <ul class="job-offer-section__list">
              @for (item of data()!.about.items; track $index) {
                <li class="job-offer-section__item">{{ item }}</li>
              }
            </ul>
          </section>
        }

        @if (data()!.competencies.items && data()!.competencies.items.length > 0) {
          <section class="job-offer-section">
            <h2 class="job-offer-section__title">{{ data()!.competencies.title }}</h2>
            <ul class="job-offer-section__list">
              @for (item of data()!.competencies.items; track $index) {
                <li class="job-offer-section__item">{{ item }}</li>
              }
            </ul>
          </section>
        }

        @if (data()!.benefits.items && data()!.benefits.items.length > 0) {
          <section class="job-offer-section">
            <h2 class="job-offer-section__title">{{ data()!.benefits.title }}</h2>
            <ul class="job-offer-section__list">
              @for (item of data()!.benefits.items; track $index) {
                <li class="job-offer-section__item">{{ item }}</li>
              }
            </ul>
          </section>
        }

        @if (data()!.skills.skills && data()!.skills.skills.length > 0) {
          <section class="job-offer-section">
            <h2 class="job-offer-section__title">Wymagane umiejętności</h2>
            <div class="job-offer-section__skills">
              @for (skill of data()!.skills.skills; track skill) {
                <span class="job-offer-section__skill">{{ skill }}</span>
              }
            </div>
          </section>
        }

        @if (data() && (data()!.location.address || (data()!.location.latitude && data()!.location.longitude))) {
          <section class="job-offer-section">
            <h2 class="job-offer-section__title">Lokalizacja miejsca pracy</h2>
            @if (mapsLoaded$ | async) {
              @if (data() && data()!.location.latitude && data()!.location.longitude) {
                <div class="job-offer-section__map">
                  <google-map
                    [options]="mapOptions()"
                    width="100%"
                    height="400px"
                  >
                    <map-marker
                      [position]="markerPosition()"
                      [options]="markerOptions()"
                    ></map-marker>
                  </google-map>
                </div>
              }
            } @else {
              @if (data() && data()!.location.latitude && data()!.location.longitude) {
                <div class="job-offer-section__map-placeholder">
                  <span>Ładowanie mapy...</span>
                </div>
              }
            }
            @if (data() && data()!.location.address) {
              <p class="job-offer-section__address">{{ data()!.location.address }}</p>
            }
          </section>
        }
      }
    </div>
  </main>
</div>
